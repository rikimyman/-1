<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Platone - Crypto Market Data</title>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
        <link rel="stylesheet" href="styles.css">
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    </head>
<body>
    <!-- Add this right after <body> tag -->
        <nav class="side-navigation">
            <div class="side-nav-logo">
                <img src="logoj copy.png" alt="Platone Logo">
            </div>
            <ul class="side-nav-items">
                <li class="side-nav-item active">
                    <a href="#dashboard">
                        <span class="nav-icon material-icons">dashboard</span>
                        <span class="nav-label">Dashboard</span>
                    </a>
                </li>
                <li class="side-nav-item">
                    <a href="#features">
                        <span class="nav-icon material-icons">insights</span>
                        <span class="nav-label">Features</span>
                    </a>
                </li>
                <li class="side-nav-item">
                    <a href="#deepchart">
                        <span class="nav-icon material-icons">candlestick_chart</span>
                        <span class="nav-label">Chart</span>
                    </a>
                </li>
                <li class="side-nav-item">
                    <a href="#etfs">
                        <span class="nav-icon material-icons">account_balance</span>
                        <span class="nav-label">ETFs</span>
                    </a>
                </li>
                <li class="side-nav-item">
                    <a href="#news">
                        <span class="nav-icon material-icons">article</span>
                        <span class="nav-label">News</span>
                    </a>
                </li>
                <li class="side-nav-item">
                    <a href="#zenus">
                        <span class="nav-icon">
                            <img src="zenus.png" alt="Zenus" style="width: 22px; height: 22px;">
                        </span>
                        <span class="nav-label">Zenus AI</span>
                    </a>
                </li>
                <li class="side-nav-item">
                    <a href="#profile">
                        <span class="nav-icon material-icons">account_circle</span>
                        <span class="nav-label">Profile</span>
                    </a>
                </li>
            </ul>
        </nav>
        <!-- Bottom Navigation Bar -->
<!-- Bottom Navigation Bar -->
<nav class="bottom-navigation">
    <a href="#home" class="nav-item">
        <span class="material-symbols-outlined">home</span>
        <span class="nav-label">Home</span>
    </a>
    <a href="#zenus" class="nav-item">
        <span class="nav-icon">
            <img src="zenus.png" alt="Zenus" class="zenus-icon">
        </span>
        <span class="nav-label">Zenus</span>
    </a>
    <a href="#charts" class="nav-item">
        <span class="material-symbols-outlined">
monitoring
</span>
        <span class="nav-label">Charts</span>
    </a>
    <a href="wallet.html" class="nav-item">
        <span class="material-symbols-outlined">wallet</span>
        <span class="nav-label">Wallet</span>
    </a>
    <a href="#profile" class="nav-item">
        <span class="material-symbols-outlined">person</span>
        <span class="nav-label">Profile</span>
    </a>

</nav>
       
        <!-- Add this as a new item in your side-nav-items list -->

</nav>
    <header class="site-header">
        <div class="logo-container">
            <img src="logoj copy.png" alt="Platone Logo" class="logo">
            <h1 class="site-title">Platone</h1>
        </div>
        <div class="header-controls">
            <button id="theme-toggle" class="theme-toggle">
                <svg class="dark-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20"><path fill="currentColor" d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10zm0-2V4a8 8 0 0 1 0 16z"/></svg>
                <svg class="light-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20"><path fill="currentColor" d="M12 18a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM11 1h2v3h-2V1zm0 19h2v3h-2v-3zM3.515 4.929l1.414-1.414L7.05 5.636 5.636 7.05 3.515 4.93zM16.95 18.364l1.414-1.414 2.121 2.121-1.414 1.414-2.121-2.121zm2.121-14.85l1.414 1.415-2.121 2.121-1.414-1.414 2.121-2.121zM5.636 16.95l1.414 1.414-2.121 2.121-1.414-1.414 2.121-2.121zM23 11v2h-3v-2h3zM4 11v2H1v-2h3z"/></svg>
            </button>
        </div>
        
    </header>

    
    <div class="container">
        <div class="button-container">
            <button class="BTC">
                MCap
                <span id="total-market-cap">Loading...</span>
            </button>
            <button class="ETH">
                24h Vol
                <span id="total-volume">Loading...</span>
            </button>
            <button class="efud">
                ETH Funding
                <span id="eth-funding-rate">Loading...</span>
            </button>
            <button class="bfud">
                BTC Funding
                <span id="funding-rate">Loading...</span>
            </button>
            <button class="btc">
                BTC DOM
                <span id="btc-dominance">Loading...</span>
            </button>
            <button class="fear-greed" id="fear-greed-button">
                Fear Index 24H
                <div class="gauge-container">
                    <div class="gauge">
                        <div class="gauge-fill"></div>
                        <div class="gauge-marker"></div>
                    </div>
                    <div class="gauge-label" id="fear-greed-value">Loading...</div>
                </div>
            </button>
            
            <div class="price-range-panel">
                <h3 class="panel-title">Day Range</h3>
                <div class="price-slider">
                    <span id="day-low" class="range-label range-low">$0</span>
                    <div class="slider-bar">
                        <div class="slider-knob"></div>
                    </div>
                    <span id="day-high" class="range-label range-high">$0</span>
                </div>
                <div class="current-price" id="btc-current-price">
                    <span id="btc-price-value">$0</span>
                    <span class="price-indicator" id="btc-price-indicator"></span>
                </div>
                <div class="chart-container">
                    <canvas id="price-chart"></canvas>
                </div>
            </div>
            
            <!-- New Open Interest Panel -->
            <div class="price-range-panel open-interest-panel">
                <h3 class="panel-title">
                    Open Interest
                    <select id="contract-selector" class="contract-selector">
                        <option value="BTCUSDT" selected>BTCUSD Perpetual</option>
                        <option value="ETHUSDT">ETHUSD Perpetual</option>
                    </select>
                </h3>
                <div class="open-interest-value">
                    <span id="open-interest-value">Loading...</span>
                </div>
                <div class="open-interest-change">
                    <span>24H Change: </span>
                    <span id="open-interest-change" class="change-indicator"></span>
                </div>
                <div class="chart-container">
                    <canvas id="open-interest-chart"></canvas>
                </div>
            </div>
            
            <!-- New Long vs Short Ratio Panel -->
            <div class="price-range-panel long-short-panel">
                <h3 class="panel-title">
                    Long/Short Ratio
                    <select id="longshort-contract-selector" class="contract-selector">
                        <option value="BTCUSDT" selected>BTCUSD Perpetual</option>
                        <option value="ETHUSDT">ETHUSD Perpetual</option>
                    </select>
                </h3>
                <div class="longshort-container">
                    <div class="longshort-ratio-container">
                        <div class="ratio-value-container">
                            <div class="ratio-value" id="longshort-ratio">0.00</div>
                            <div class="ratio-label">Long/Short Ratio</div>
                        </div>
                        <div class="longshort-percentages">
                            <div class="long-percentage">
                                <span class="percentage-value" id="long-percentage">0%</span>
                                <span class="percentage-label">Long</span>
                            </div>
                            <div class="short-percentage">
                                <span class="percentage-value" id="short-percentage">0%</span>
                                <span class="percentage-label">Short</span>
                            </div>
                        </div>
                    </div>
                    <div class="pie-chart-container">
                        <canvas id="longshort-pie-chart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Market Overview Section - Moved outside containers -->
    <div class="market-overview-section no-border">
        <div class="market-overview-header">
            <div class="market-icon-container">
                <div class="market-icon">
                    <i class="material-icons">bar_chart</i>
                </div>
                <span class="market-title">MARKET OVERVIEW</span>
            </div>
        </div>
        
        <div class="market-controls-container">
            <div class="left-controls">
                <div class="search-container">
                    <i class="material-icons search-icon">search</i>
                    <input type="text" class="market-search" placeholder="Search assets...">
                </div>
                <div class="filter-buttons">
                    <button class="filter-btn active">All</button>
                    <button class="filter-btn">DeFi</button>
                    <button class="filter-btn">Layer1</button>
                    <button class="filter-btn">Meme</button>
                    <button class="filter-btn">AI</button>
                </div>
            </div>
            <div class="right-controls">
                <div class="time-toggles">
                    <button class="time-toggle active">1h</button>
                    <button class="time-toggle">24h</button>
                    <button class="time-toggle">7d</button>
                </div>
            </div>
        </div>
        
        <!-- Add the crypto cards container -->
        <div id="crypto-cards-container" class="crypto-cards-container">
            <!-- Cards will be dynamically generated here -->
        </div>
    </div>
    
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="crypto-cards.css">
    <script src="crypto-cards.js"></script>
    <script>
        // Theme toggle functionality
        document.getElementById('theme-toggle').addEventListener('click', function() {
            document.body.classList.toggle('dark-theme');
            localStorage.setItem('theme', document.body.classList.contains('dark-theme') ? 'dark' : 'light');
        });
        
        // Check for saved theme preference
        if (localStorage.getItem('theme') === 'dark') {
            document.body.classList.add('dark-theme');
        }

        async function fetchBTCFundingRate() {
            try {
                const response = await fetch('https://fapi.binance.com/fapi/v1/fundingRate?symbol=BTCUSDT');
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                const data = await response.json();
                if (data && data.length > 0 && data[0].fundingRate) {
                    const fundingRate = data[0].fundingRate;
                    document.getElementById('funding-rate').innerText = `${(fundingRate * 100).toFixed(4)}%`;
                } else {
                    throw new Error('Invalid data format');
                }
            } catch (error) {
                console.error('Error fetching BTC funding rate:', error);
                document.getElementById('funding-rate').innerText = 'N/A';
            }
        }

        async function fetchETHFundingRate() {
            try {
                const response = await fetch('https://fapi.binance.com/fapi/v1/fundingRate?symbol=ETHUSDT');
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                const data = await response.json();
                if (data && data.length > 0 && data[0].fundingRate) {
                    const fundingRate = data[0].fundingRate;
                    document.getElementById('eth-funding-rate').innerText = `${(fundingRate * 100).toFixed(4)}%`;
                } else {
                    throw new Error('Invalid data format');
                }
            } catch (error) {
                console.error('Error fetching ETH funding rate:', error);
                document.getElementById('eth-funding-rate').innerText = 'N/A';
            }
        }

        async function fetchMarketData() {
            try {
                // Try CoinGecko API
                let response = await fetch('https://api.coingecko.com/api/v3/global');
                
                // Check if response is ok
                if (!response.ok) {
                    throw new Error('CoinGecko API error');
                }
                
                const data = await response.json();
                
                // Format market cap (abbreviate to B or T)
                const formatLargeNumber = (num) => {
                    if (num >= 1e12) return (num / 1e12).toFixed(2) + 'T';
                    if (num >= 1e9) return (num / 1e9).toFixed(2) + 'B';
                    if (num >= 1e6) return (num / 1e6).toFixed(2) + 'M';
                    return num.toLocaleString();
                };
                
                // Get total market cap and 24h volume
                if (data && data.data) {
                    const totalMarketCap = data.data.total_market_cap.usd;
                    const totalVolume = data.data.total_volume.usd;
                    
                    // Format and display data
                    document.getElementById('total-market-cap').innerText = formatLargeNumber(totalMarketCap);
                    document.getElementById('total-volume').innerText = formatLargeNumber(totalVolume);
                    
                    // Get BTC dominance data if available
                    if (data.data.market_cap_percentage && data.data.market_cap_percentage.btc) {
                        const btcDominance = data.data.market_cap_percentage.btc;
                        document.getElementById('btc-dominance').innerText = `${btcDominance.toFixed(2)}%`;
                        console.log("BTC dominance updated:", btcDominance); // Add logging to verify data is being received
                    } else {
                        console.error("BTC dominance data not available in API response");
                        document.getElementById('btc-dominance').innerText = 'N/A';
                    }
                } else {
                    throw new Error('Invalid data format');
                }
            } catch (error) {
                console.error('Error fetching market data:', error);
                // Fallback to manual fetch for BTC dominance if the main API call fails
                try {
                    const btcResponse = await fetch('https://api.coingecko.com/api/v3/coins/bitcoin');
                    const totalResponse = await fetch('https://api.coingecko.com/api/v3/global');
                    
                    if (btcResponse.ok && totalResponse.ok) {
                        const btcData = await btcResponse.json();
                        const totalData = await totalResponse.json();
                        
                        if (btcData.market_data && btcData.market_data.market_cap && totalData.data && totalData.data.total_market_cap) {
                            const btcMarketCap = btcData.market_data.market_cap.usd;
                            const totalMarketCap = totalData.data.total_market_cap.usd;
                            const dominance = (btcMarketCap / totalMarketCap) * 100;
                            document.getElementById('btc-dominance').innerText = `${dominance.toFixed(2)}%`;
                        } else {
                            document.getElementById('btc-dominance').innerText = 'N/A';
                        }
                    } else {
                        document.getElementById('btc-dominance').innerText = 'N/A';
                    }
                } catch (fallbackError) {
                    console.error('Error in fallback for BTC dominance:', fallbackError);
                    document.getElementById('btc-dominance').innerText = 'N/A';
                }
                
                // Fallback to static values for other metrics
                document.getElementById('total-market-cap').innerText = '~2.42T';
                document.getElementById('total-volume').innerText = '~78.5B';
            }
        }

        async function fetchFearGreedIndex() {
            try {
                const response = await fetch('https://api.alternative.me/fng/');
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                const data = await response.json();
                
                if (data && data.data && data.data[0]) {
                    const value = parseInt(data.data[0].value);
                    const classification = data.data[0].value_classification;
                    
                    // Update the gauge marker position based on the value (0-100)
                    const markerPosition = value + '%';
                    document.querySelector('.gauge-marker').style.left = markerPosition;
                    
                    // Update the gauge label
                    document.getElementById('fear-greed-value').innerText = `${value} - ${classification}`;
                    
                    // Add class based on the sentiment
                    const fearGreedButton = document.getElementById('fear-greed-button');
                    fearGreedButton.classList.remove('extreme-fear', 'fear', 'neutral', 'greed', 'extreme-greed');
                    
                    if (value <= 20) {
                        fearGreedButton.classList.add('extreme-fear');
                    } else if (value <= 40) {
                        fearGreedButton.classList.add('fear');
                    } else if (value <= 60) {
                        fearGreedButton.classList.add('neutral');
                    } else if (value <= 80) {
                        fearGreedButton.classList.add('greed');
                    } else {
                        fearGreedButton.classList.add('extreme-greed');
                    }
                } else {
                    throw new Error('Invalid data format');
                }
            } catch (error) {
                console.error('Error fetching Fear & Greed index:', error);
                document.getElementById('fear-greed-value').innerText = 'N/A';
            }
        }
        
        // Price chart instance
        let priceChart;
        
        // Track price history for determining trends
        let previousPrice = 0;
        
        async function fetchBitcoinPriceData() {
            try {
                const response = await fetch('https://api.coingecko.com/api/v3/coins/bitcoin/market_chart?vs_currency=usd&days=1');
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                const data = await response.json();
                
                if (data && data.prices && data.prices.length > 0) {
                    // Extract price data
                    const prices = data.prices;
                    const currentPrice = prices[prices.length - 1][1];
                    
                    // Find day's high and low
                    let dayHigh = -Infinity;
                    let dayLow = Infinity;
                    const chartLabels = [];
                    const chartData = [];
                    
                    prices.forEach(price => {
                        const timestamp = new Date(price[0]);
                        const priceValue = price[1];
                        
                        // Update high and low
                        if (priceValue > dayHigh) dayHigh = priceValue;
                        if (priceValue < dayLow) dayLow = priceValue;
                        
                        // Format time for chart label (HH:MM)
                        const hours = timestamp.getHours().toString().padStart(2, '0');
                        const minutes = timestamp.getMinutes().toString().padStart(2, '0');
                        chartLabels.push(`${hours}:${minutes}`);
                        chartData.push(priceValue);
                    });
                    
                    // Update price display
                    updatePriceDisplay(currentPrice, previousPrice);
                    previousPrice = currentPrice;
                    
                    // Display day's range
                    document.getElementById('day-low').innerText = `$${dayLow.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
                    document.getElementById('day-high').innerText = `$${dayHigh.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
                    
                    // Calculate position of the knob
                    const rangeTotal = dayHigh - dayLow;
                    const currentInRange = ((currentPrice - dayLow) / rangeTotal) * 100;
                    document.querySelector('.slider-knob').style.left = `${currentInRange}%`;
                    
                    // Update or create chart with appropriate color
                    updatePriceChart(chartLabels, chartData);
                    
                } else {
                    throw new Error('Invalid data format');
                }
            } catch (error) {
                console.error('Error fetching Bitcoin price data:', error);
                document.getElementById('btc-price-value').innerText = 'N/A';
                document.getElementById('btc-price-indicator').innerHTML = '';
                document.getElementById('day-low').innerText = 'N/A';
                document.getElementById('day-high').innerText = 'N/A';
            }
        }
        
        function updatePriceDisplay(currentPrice, previousPrice) {
            const priceValueElement = document.getElementById('btc-price-value');
            const priceIndicatorElement = document.getElementById('btc-price-indicator');
            
            // Update price text
            priceValueElement.innerText = `$${currentPrice.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
            
            // Determine price movement and update indicator
            if (previousPrice === 0) {
                // Initial load, no indicator yet
                priceIndicatorElement.innerHTML = '';
                priceValueElement.style.color = '#4daf7c'; // Default to green
            } else if (currentPrice > previousPrice) {
                // Price up
                priceIndicatorElement.innerHTML = '<div class="price-up-arrow"></div>';
                priceValueElement.style.color = '#4daf7c'; // Green
            } else if (currentPrice < previousPrice) {
                // Price down
                priceIndicatorElement.innerHTML = '<div class="price-down-arrow"></div>';
                priceValueElement.style.color = '#e63946'; // Red
            } else {
                // Price unchanged
                priceIndicatorElement.innerHTML = '';
            }
        }
     // Update the price chart configuration
function updatePriceChart(labels, data) {
    const ctx = document.getElementById('price-chart').getContext('2d');
    
    // Determine if price is up or down for coloring
    const lineColor = data[data.length - 1] >= data[0] ? '#4daf7c' : '#e63946';
    
    // Create chart if it doesn't exist, otherwise update it
    if (!priceChart) {
        priceChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [{
                    data: data,
                    borderColor: lineColor,
                    borderWidth: 2,
                    pointRadius: 0,
                    tension: 0.2,
                    fill: false // Disable the background fill
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        enabled: true,
                        mode: 'index',
                        intersect: false,
                        callbacks: {
                            label: function(context) {
                                let value = context.raw;
                                return `$${value.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        display: false
                    },
                    y: {
                        display: false
                    }
                },
                animation: false,
                hover: {
                    mode: 'index',
                    intersect: false
                }
            }
        });
    } else {
        priceChart.data.labels = labels;
        priceChart.data.datasets[0].data = data;
        priceChart.data.datasets[0].borderColor = lineColor;
        priceChart.data.datasets[0].fill = false; // Ensure fill is disabled
        priceChart.update();
    }
}
        
        // Track BTC day high and low
        let btcDayHigh = -Infinity;
        let btcDayLow = Infinity;
        let chartLabels = [];
        let chartData = [];
        
        // Track open interest data
        let openInterestChart;
        let openInterestLabels = [];
        let openInterestData = [];
        let previousOpenInterest = 0;
        let selectedContract = 'BTCUSDT';
        
        // Track long/short ratio data
        let longShortPieChart;
        let selectedLongShortContract = 'BTCUSDT';
        
        // Function to refresh data periodically
        function refreshData() {
            fetchBTCFundingRate();
            fetchETHFundingRate();
            fetchMarketData();
            fetchFearGreedIndex();
            // Initial data fetch, will be updated by WebSocket
            fetchInitialBitcoinPriceData();
            fetchOpenInterestData(selectedContract);
            fetchLongShortRatio(selectedLongShortContract);
        }
        
        // Get initial Bitcoin price data
        async function fetchInitialBitcoinPriceData() {
            try {
                const response = await fetch('https://api.binance.com/api/v3/klines?symbol=BTCUSDT&interval=1m&limit=1440');
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                const data = await response.json();
                
                if (data && data.length > 0) {
                    // Reset tracking variables
                    btcDayHigh = -Infinity;
                    btcDayLow = Infinity;
                    chartLabels = [];
                    chartData = [];
                    
                    // Process kline data
                    data.forEach(kline => {
                        const timestamp = new Date(kline[0]);
                        const high = parseFloat(kline[2]);
                        const low = parseFloat(kline[3]);
                        const close = parseFloat(kline[4]);
                        
                        // Update day high/low
                        if (high > btcDayHigh) btcDayHigh = high;
                        if (low < btcDayLow) btcDayLow = low;
                        
                        // Format time for chart (HH:MM)
                        const hours = timestamp.getHours().toString().padStart(2, '0');
                        const minutes = timestamp.getMinutes().toString().padStart(2, '0');
                        chartLabels.push(`${hours}:${minutes}`);
                        chartData.push(close);
                    });
                    
                    // Get current price (last close)
                    const currentPrice = chartData[chartData.length - 1];
                    
                    // Update displays
                    updatePriceDisplay(currentPrice, previousPrice);
                    previousPrice = currentPrice;
                    
                    // Display day's range
                    updateDayRange(btcDayLow, btcDayHigh, currentPrice);
                    
                    // Update chart
                    updatePriceChart(chartLabels, chartData);
                    
                    // Now connect to WebSocket for real-time updates
                    connectBinanceWebSocket();
                } else {
                    throw new Error('Invalid data format');
                }
            } catch (error) {
                console.error('Error fetching initial Bitcoin price data:', error);
                document.getElementById('btc-price-value').innerText = 'N/A';
                document.getElementById('btc-price-indicator').innerHTML = '';
                document.getElementById('day-low').innerText = 'N/A';
                document.getElementById('day-high').innerText = 'N/A';
            }
        }
        
        // Update day range display and slider
        function updateDayRange(low, high, current) {
            document.getElementById('day-low').innerText = `$${low.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
            document.getElementById('day-high').innerText = `$${high.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
            
            // Calculate position of the knob
            const rangeTotal = high - low;
            const currentInRange = ((current - low) / rangeTotal) * 100;
            document.querySelector('.slider-knob').style.left = `${Math.max(0, Math.min(100, currentInRange))}%`;
        }
        
        // Connect to Binance WebSocket for real-time BTC price updates
        function connectBinanceWebSocket() {
            const socket = new WebSocket('wss://stream.binance.com:9443/ws/btcusdt@ticker');
            
            socket.onmessage = function(event) {
                const data = JSON.parse(event.data);
                if (data) {
                    // Get current price and 24hr high/low
                    const currentPrice = parseFloat(data.c);
                    const dayHigh = parseFloat(data.h);
                    const dayLow = parseFloat(data.l);
                    
                    // Update our tracking variables
                    btcDayHigh = dayHigh;
                    btcDayLow = dayLow;
                    
                    // Update price display
                    updatePriceDisplay(currentPrice, previousPrice);
                    
                    // Update day range and slider
                    updateDayRange(dayLow, dayHigh, currentPrice);
                    
                    // Add to chart data (keeping only recent points)
                    const now = new Date();
                    const hours = now.getHours().toString().padStart(2, '0');
                    const minutes = now.getMinutes().toString().padStart(2, '0');
                    
                    // Add new data point every 15 seconds to avoid cluttering the chart
                    if (now.getSeconds() % 15 === 0) {
                        chartLabels.push(`${hours}:${minutes}`);
                        chartData.push(currentPrice);
                        
                        // Keep chart data at a reasonable size
                        if (chartLabels.length > 100) {
                            chartLabels.shift();
                            chartData.shift();
                        }
                        
                        // Update chart
                        updatePriceChart(chartLabels, chartData);
                    }
                    
                    previousPrice = currentPrice;
                }
            };
            
            socket.onclose = function() {
                // Try to reconnect after a brief delay
                console.log('WebSocket connection closed. Reconnecting...');
                setTimeout(connectBinanceWebSocket, 5000);
            };
            
            socket.onerror = function(error) {
                console.error('WebSocket error:', error);
                socket.close();
            };
        }
        
        // Fetch BTC Open Interest data
        async function fetchOpenInterestData(contract = 'BTCUSDT') {
            try {
                // Using Binance API to get open interest data
                const response = await fetch(`https://fapi.binance.com/fapi/v1/openInterest?symbol=${contract}`);
                const histResponse = await fetch(`https://fapi.binance.com/futures/data/openInterestHist?symbol=${contract}&period=1h&limit=24`);
                
                if (!response.ok || !histResponse.ok) {
                    throw new Error('Failed to fetch open interest data');
                }
                
                const data = await response.json();
                const histData = await histResponse.json();
                
                if (data && data.openInterest && histData && histData.length > 0) {
                    // Current open interest in crypto
                    const openInterestCrypto = parseFloat(data.openInterest);
                    
                    // Get current price to convert to USD value
                    const priceResponse = await fetch(`https://api.binance.com/api/v3/ticker/price?symbol=${contract}`);
                    const priceData = await priceResponse.json();
                    const price = parseFloat(priceData.price);
                    
                    // Calculate open interest in USD
                    const openInterestUSD = openInterestCrypto * price;
                    
                    // Format with full number
                    const formattedValue = '$' + openInterestUSD.toLocaleString(undefined, {
                        minimumFractionDigits: 0,
                        maximumFractionDigits: 0
                    });
                    
                    // Process historical data for chart
                    openInterestLabels = [];
                    openInterestData = [];
                    
                    histData.forEach(item => {
                        const timestamp = new Date(item.timestamp);
                        const hours = timestamp.getHours().toString().padStart(2, '0');
                        const minutes = timestamp.getMinutes().toString().padStart(2, '0');
                        openInterestLabels.push(`${hours}:${minutes}`);
                        
                        // Convert to USD
                        const oiValue = parseFloat(item.sumOpenInterest) * parseFloat(item.sumOpenInterestValue) / parseFloat(item.sumOpenInterest);
                        openInterestData.push(oiValue);
                    });
                    
                    // Calculate percentage change
                    const currentOI = openInterestData[openInterestData.length - 1];
                    const previousOI = openInterestData[0];
                    const changePercent = ((currentOI - previousOI) / previousOI) * 100;
                    
                    // Update display
                    document.getElementById('open-interest-value').innerText = formattedValue;
                    
                    // Show percentage change with color
                    const changeElement = document.getElementById('open-interest-change');
                    if (changePercent > 0) {
                        changeElement.innerText = `+${changePercent.toFixed(2)}%`;
                        changeElement.classList.add('positive');
                        changeElement.classList.remove('negative');
                    } else {
                        changeElement.innerText = `${changePercent.toFixed(2)}%`;
                        changeElement.classList.add('negative');
                        changeElement.classList.remove('positive');
                    }
                    
                    // Update chart
                    updateOpenInterestChart();
                    
                } else {
                    throw new Error('Invalid data format');
                }
            } catch (error) {
                console.error('Error fetching open interest data:', error);
                document.getElementById('open-interest-value').innerText = 'N/A';
                document.getElementById('open-interest-change').innerText = '';
            }
        }
        
        // Update the open interest chart
function updateOpenInterestChart() {
    const ctx = document.getElementById('open-interest-chart').getContext('2d');
    
    // Determine if open interest is up or down for coloring
    const isUp = openInterestData[openInterestData.length - 1] >= openInterestData[0];
    const lineColor = isUp ? '#4daf7c' : '#e63946';
    
    // Create chart if it doesn't exist, otherwise update it
    if (!openInterestChart) {
        openInterestChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: openInterestLabels,
                datasets: [{
                    data: openInterestData,
                    borderColor: lineColor,
                    borderWidth: 3,
                    pointRadius: 0,
                    tension: 0.2,
                    fill: false // Disable the background fill
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        enabled: true,
                        mode: 'index',
                        intersect: false,
                        callbacks: {
                            label: function(context) {
                                let value = context.raw;
                                return `$${value.toLocaleString(undefined, {minimumFractionDigits: 0, maximumFractionDigits: 0})}`;
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        display: false
                    },
                    y: {
                        display: false
                    }
                },
                animation: false,
                hover: {
                    mode: 'index',
                    intersect: false
                }
            }
        });
    } else {
        openInterestChart.data.labels = openInterestLabels;
        openInterestChart.data.datasets[0].data = openInterestData;
        openInterestChart.data.datasets[0].borderColor = lineColor;
        openInterestChart.data.datasets[0].fill = false; // Ensure fill is disabled
        openInterestChart.update();
    }
}
        
        // Fetch Long/Short Ratio data
        async function fetchLongShortRatio(contract = 'BTCUSDT') {
            try {
                const response = await fetch(`https://fapi.binance.com/futures/data/globalLongShortAccountRatio?symbol=${contract}&period=1h&limit=1`);
                
                if (!response.ok) {
                    throw new Error('Failed to fetch long/short ratio data');
                }
                
                const data = await response.json();
                
                if (data && data.length > 0) {
                    const latestData = data[0];
                    const longShortRatio = parseFloat(latestData.longShortRatio);
                    
                    // Calculate percentages
                    const longPercentage = (longShortRatio / (longShortRatio + 1)) * 100;
                    const shortPercentage = 100 - longPercentage;
                    
                    // Update display
                    document.getElementById('longshort-ratio').innerText = longShortRatio.toFixed(2);
                    document.getElementById('long-percentage').innerText = `${longPercentage.toFixed(1)}%`;
                    document.getElementById('short-percentage').innerText = `${shortPercentage.toFixed(1)}%`;
                    
                    // Update pie chart
                    updateLongShortPieChart(longPercentage, shortPercentage);
                } else {
                    throw new Error('Invalid data format');
                }
            } catch (error) {
                console.error('Error fetching long/short ratio data:', error);
                document.getElementById('longshort-ratio').innerText = 'N/A';
                document.getElementById('long-percentage').innerText = 'N/A';
                document.getElementById('short-percentage').innerText = 'N/A';
            }
        }
        
        // Update the long/short ratio pie chart
        function updateLongShortPieChart(longPercentage, shortPercentage) {
            const ctx = document.getElementById('longshort-pie-chart').getContext('2d');
            
            // Create chart if it doesn't exist, otherwise update it
            if (!longShortPieChart) {
                longShortPieChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Long', 'Short'],
                        datasets: [{
                            data: [longPercentage, shortPercentage],
                            backgroundColor: ['#4daf7c', '#e63946'],
                            borderColor: ['#4daf7c', '#e63946'],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        cutout: '65%',
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `${context.label}: ${context.raw.toFixed(1)}%`;
                                    }
                                }
                            }
                        },
                        animation: {
                            animateRotate: true,
                            animateScale: true
                        }
                    }
                });
            } else {
                longShortPieChart.data.datasets[0].data = [longPercentage, shortPercentage];
                longShortPieChart.update();
            }
        }
        
        // Initial load
        refreshData();
        
        // Standard refresh every 5 minutes for market data, funding rates, etc.
        setInterval(() => {
            fetchBTCFundingRate();
            fetchETHFundingRate();
            fetchMarketData();
            fetchFearGreedIndex();
        }, 5 * 60 * 1000);

        // Add click event listener to crypto cards and contract selectors
        document.addEventListener('DOMContentLoaded', function() {
            // This will be triggered after crypto-cards.js generates the cards
            document.body.addEventListener('click', function(event) {
                // Find the closest crypto card parent element if any
                const card = event.target.closest('.crypto-card');
                if (card && card.dataset.symbol) {
                    const coinSymbol = card.dataset.symbol;
                    const coinId = card.dataset.id || coinSymbol.toLowerCase();
                    window.location.href = `coin-detail.html?id=${coinId}&symbol=${coinSymbol}`;
                }
            });

            const contractSelector = document.getElementById('contract-selector');
            if (contractSelector) {
                contractSelector.addEventListener('change', function() {
                    selectedContract = this.value;
                    fetchOpenInterestData(selectedContract);
                });
            }
            
            const longShortContractSelector = document.getElementById('longshort-contract-selector');
            if (longShortContractSelector) {
                longShortContractSelector.addEventListener('change', function() {
                    selectedLongShortContract = this.value;
                    fetchLongShortRatio(selectedLongShortContract);
                });
            }
        });
        
    </script>
    
    <style>
 /* Bottom Navigation */
 .bottom-navigation {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 55px;
    background-color: rgba(255, 255, 255, 0.95);
    box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.2);
    z-index: 1000;
    display: none;
    justify-content: space-around;
    align-items: center;
    padding: 0 10px;
    box-sizing: border-box;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    transition: background-color 0.3s ease;
}

body.dark-theme .bottom-navigation {
    background-color: rgba(23, 24, 23, 0.95);
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.3);
}

/* Bottom Navigation Items */
.bottom-navigation .nav-item {
    display: flex;
    align-items: center;
    justify-content: center;
    text-decoration: none;
    color: rgba(0, 0, 0, 0.8);
    transition: color 0.3s ease, transform 0.3s ease;
    flex: 1;
    height: 100%;
}

body.dark-theme .bottom-navigation .nav-item {
    color: rgba(255, 255, 255, 0.9);
}

.bottom-navigation .nav-item:hover {
    color: #f6cb8e;
    transform: scale(1.1);
}

.bottom-navigation .nav-item.active {
    color: #f6cb8e;
}

/* Bottom Navigation Icons */
.bottom-navigation .material-symbols-outlined {
    font-size: 27px;
    transition: color 0.3s ease;
}

.bottom-navigation .nav-item:hover .material-symbols-outlined {
    color: #f6cb8e;
}

/* Zenus Icon */
.bottom-navigation .zenus-icon {
    width: 28px;
    height: 22px;
    object-fit: contain;
    transition: transform 0.3s ease;
}

.bottom-navigation .nav-item:hover .zenus-icon {
    transform: scale(1.2);
}

.bottom-navigation .nav-item:hover .zenus-icon {
    transform: scale(1.2); /* Slight zoom effect on hover */
}

/* Navigation labels */
.bottom-navigation .nav-label {
    font-size: 10px; /* Smaller font size for labels */
    font-weight: 500;
    color: rgba(0, 0, 0, 0.8); /* Light mode label color */
    transition: color 0.3s ease;
    margin-top: 2px; /* Reduce spacing between icon and label */
}

body.dark-theme .bottom-navigation .nav-label {
    color: rgba(255, 255, 255, 0.8); /* Dark mode label color */
}

/* Show the bottom navigation bar only on screens â‰¤ 990px */
@media (max-width: 990px) {
    .bottom-navigation {
        display: flex;
    }
}

/* Hide the bottom navigation bar on screens > 990px */
@media (min-width: 991px) {
    .bottom-navigation {
        display: none;
    }
}
        
        /* Common styles for all containers */
        .price-range-panel, 
        .open-interest-panel, 
        .long-short-panel {
            border-radius: 12px;
            padding: 12px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            background-color: #fff;
            box-sizing: border-box;
            height: 100%;
            width: 100%; /* Ensure width is same as button width */
            margin: 0; /* Remove any margin that could affect width */
        }
        
        .dark-theme .price-range-panel, 
        .dark-theme .open-interest-panel,
        .dark-theme .long-short-panel {
            background-color: #171817;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        
       /* Specific button styling for the first two rows */
.button-container > button {
    border-radius: 12px;
    border: none;
    background-color: #fff;
    color: #918989;
    font-weight: 500;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: space-between;
    text-align: left;
    cursor: pointer;
    padding: 12px 16px;
    box-sizing: border-box;
    height: 100%;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    width: calc(100% + 1px); /* Make buttons 4px wider instead of 2px */
    margin-left: 1px; /* Adjust margin to center the wider buttons */
}
        
        .button-container > button > span {
            display: block;
            font-size: 15px;
            font-weight: 600;
            margin-top: 0; /* No top margin needed */
            margin-left: auto; /* Push to right */
            padding-left: 10px; /* Add some space between text and value */
        }
        
        /* Fear & Greed button needs special handling */
        .button-container > button.fear-greed {
            flex-direction: column;
            justify-content: center;
            text-align: center;
            padding-bottom: 5px;
        }
        
        .button-container > button.fear-greed span {
            margin-left: 0;
            padding-left: 0;
        }
        
        /* Dark theme adjustments for buttons */
        .dark-theme .button-container > button {
            background-color: #171817; /* Dark background */
            border: 2px solid #3c3d37; /* Dark border */
            color: #fff; /* Light text */
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        
        /* Panel title styling */
        .panel-title {
            margin-top: 0;
            margin-bottom: 10px;
            font-size: 15px;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        /* Contract selector styles */
        .contract-selector {
            margin-left: 6px;
            padding: 2px 5px;
            font-size: 11px;
            border-radius: 4px;
            border: 1px solid #ccc;
            background: transparent;
            color: inherit;
        }
        
        /* Long/Short Ratio Styles */
        .longshort-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 100px;
        }
        
        .ratio-value-container {
            text-align: center;
            margin-bottom: 8px;
        }
        
        .ratio-value {
            font-size: 20px;
            font-weight: bold;
        }
        
        .ratio-label {
            font-size: 11px;
            opacity: 0.7;
        }
        
        .longshort-percentages {
            display: flex;
            justify-content: space-around;
        }
        
        .long-percentage, .short-percentage {
            text-align: center;
            display: flex;
            flex-direction: column;
        }
        
        .percentage-value {
            font-weight: bold;
            font-size: 14px;
        }
        
        .long-percentage .percentage-value {
            color: #4daf7c;
        }
        
        .short-percentage .percentage-value {
            color: #e63946;
        }
        
        .percentage-label {
            font-size: 12px;
            color: #eacfa6
        }
        
        .pie-chart-container {
            flex: 10;
            height: 130px;
            margin-top: 39px;
            margin-right: 9px;
            position: relative;
        }
        
        /* Other styles */
        .open-interest-value {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 8px 0 4px;
            font-size: 16px;
            font-weight: 600;
        }
        
        .open-interest-change {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 8px;
            font-size: 13px;
        }
        
        .change-indicator {
            margin-left: 4px;
            font-weight: 500;
        }
        
        .change-indicator.positive {
            color: #4daf7c;
        }
        
        .change-indicator.negative {
            color: #e63946;
        }
        
        /* Chart container styling - smaller height */
        .chart-container {
            height: 50px;
            margin-top: 8px;
            position: relative;
        }
        
        /* Price slider styles */
        .price-slider {
            width: 100%;
            display: flex;
            align-items: center;
            margin: 10px 0;
        }
        
        .slider-bar {
            flex-grow: 1;
            height: 4px;
            background-color: #e9ecef;
            border-radius: 2px;
            margin: 0 8px;
            position: relative;
        }
        
        .slider-knob {
            width: 10px;
            height: 10px;
            background-color: #6e6e6e;
            border-radius: 50%;
            border: 2px solid   #dbdde2;
            position: absolute;
            top: 50%;
            transform: translate(-50%, -50%);
            z-index: 2;
        }
        
        .range-label {
            font-size: 13px;
            color: #6c757d;
        }
        
        /* Current price display */
        .current-price {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        #btc-price-value {
            font-size: 18px;
            font-weight: bold;
        }
        
        /* Responsive layout for different screen sizes */
        @media (max-width: 767px) {
            /* On mobile, stack all elements */
            .button-container {
                display: flex;
                flex-direction: column;
                gap: 12px; /* Consistent gap between all elements */
                max-width: 90%; /* Center the content */
                margin: 0 auto;
            }
            
            .button-container > button {
                height: auto;
                min-height: 50px; /* Smaller height */
                margin-bottom: 0;
            }
            
            .price-range-panel,
            .open-interest-panel,
            .long-short-panel {
                width: 100%;
                margin-top: 0; /* No extra margin */
                min-height: 170px;
            }
        }
        
        @media (min-width: 768px) {
            /* For tablets and desktops, use fixed grid with equal column widths */
            .button-container {
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                grid-template-rows: auto auto auto;
                grid-row-gap: 15px;
                grid-column-gap: 15px; /* Reduce gap slightly to accommodate wider buttons */
                margin-bottom: 15px;
                max-width: 95%;
                margin-left: auto;
                margin-right: auto;
                overflow: hidden;
            }
            
            /* First row: Market Cap, 24h Volume, BTC Dominance */
            .button-container > button:nth-child(1) { grid-column: 1; grid-row: 1; } /* Market Cap */
            .button-container > button:nth-child(2) { grid-column: 2; grid-row: 1; } /* 24h Volume */
            .button-container > button:nth-child(5) { grid-column: 3; grid-row: 1; } /* BTC Dominance */
            
            /* Second row: BTC Funding, ETH Funding, Fear & Greed */
            .button-container > button:nth-child(4) { grid-column: 1; grid-row: 2; } /* BTC Funding */
            .button-container > button:nth-child(3) { grid-column: 2; grid-row: 2; } /* ETH Funding */
            .button-container > button:nth-child(6) { grid-column: 3; grid-row: 2; } /* Fear & Greed */
            
            /* Third row: panels - centered in their grid cells */
            .price-range-panel {
                grid-column: 1;
                grid-row: 3;
            }
            
            .open-interest-panel {
                grid-column: 2;
                grid-row: 3;
            }
            
            .long-short-panel {
                grid-column: 3;
                grid-row: 3;
            }
            
            /* Make rows 1 and 2 smaller height */
            .button-container > button {
                min-height: 50px;
                box-sizing: border-box;
                max-width: calc(100% + 1px);
                width: calc(100%);
                margin-left: 0px;
            }
            
            /* Keep panels at normal width */
            .price-range-panel, 
            .open-interest-panel, 
            .long-short-panel {
                width: 100%;
                margin-left: 0;
            }
            
            /* Add this to ensure grid cells are properly constrained */
            .button-container > * {
                justify-self: stretch;
                width: 100%;
                min-width: 0;
                overflow: hidden;
                box-sizing: border-box; /* Ensure consistent box model */
            }
        }
        
        /* Small adjustments for medium screens */
        @media (min-width: 768px) and (max-width: 991px) {
            .button-container {
                grid-gap: 10px;
                max-width: 98%;
            }
            
            /* Smaller heights on medium screens */
            .button-container > button {
                min-height: 45px;
                padding: 8px 12px;
            }
            
            /* Maintain equal heights on medium screens too */
            .price-range-panel, 
            .open-interest-panel, 
            .long-short-panel {
                min-height: 160px;
                padding: 8px 12px; /* Match button padding for medium screens */
            }
        }

        /* Dark theme support for the dropdown */
        .dark-theme .contract-selector {
            background-color: #353537;
            border-color: #444;
            border-radius: 34px;
            border:1.4px solid #968f8f;
            color: #f6cb8e;
        }
        
        /* Container for the entire section - centered with max width */
        .container {
            padding: 15px;
            max-width: 1100px; /* Slightly smaller to make content more centered */
            margin: 0 auto;
            overflow: hidden; /* Prevent horizontal scrolling */
        }
        
        /* Gauge styling for fear/greed index */
        .gauge-container {
            width: 100%;
            margin-top: 8px;
        }
        
        .gauge {
            height: 8px;
            background-color: #e9ecef;
            border-radius: 4px;
            position: relative;
            margin-bottom: 5px;
        }
        
        .gauge-fill {
            height: 100%;
            border-radius: 4px;
            background: linear-gradient(
                to right,
                #e63946 0%,
                #e66c39 25%,
                #e6b139 50%,
                #71e639 75%,
                #39e655 100%
            );
        }
        
        .gauge-marker {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: #fff;
            border: 2px solid #333;
            position: absolute;
            top: 50%;
            transform: translate(-50%, -50%);
            z-index: 2;
        }
        
        .dark-theme .gauge-marker {
            background-color: #2c2f36;
            border-color: #fff;
        }
        
        /* Update background color for panels */
        .price-range-panel, 
        .open-interest-panel, 
        .long-short-panel {
            background-color: #171817; /* New background color */
            border-radius: 12px;
            padding: 12px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3); /* Adjusted shadow for dark background */
            box-sizing: border-box;
            height: 100%;
            width: 100%;
            margin: 0;
        }
    /* Add this to your existing <style> section */

/* ...existing code... */

/* Updated media query for small screens (â‰¤ 768px) with better button layout */
@media (max-width: 768px) {
    /* Only hide ETH and BTC funding rate buttons */
    .button-container > button.efud {
        display: none;
    }
    
    /* Hide BTC funding rate button */
    .button-container > button.bfud {
        display: none;
    }
    
    /* Show BTC dominance button (remove the display: none) */
    .button-container > button.btc {
        display: block;
    }
    
    /* Use flex layout with wrap for buttons */
    .button-container {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        width: 92%;
        max-width: 400px;
        margin-left: auto;
        margin-right: auto;
    }
    
    /* Override the column direction from other media queries */
    .button-container {
        flex-direction: row !important;
        justify-content: space-between;
    }
    
    /* Make all buttons take appropriate width */
    .button-container > button {
        box-sizing: border-box;
        min-height: 60px;
        height: auto;
        margin: 0;
    }
    
    /* First row: Market Cap and 24h Volume side by side */
    .button-container > button.BTC,
    .button-container > button.ETH {
        width: calc(50% - 6px); /* Half width minus half the gap */
        flex: 0 0 calc(50% - 6px);
        min-width: 0; /* Allow buttons to shrink below content size if needed */
    }
    
    /* Second row: Fear & Greed and BTC Dominance side by side */
    .button-container > button.fear-greed,
    .button-container > button.btc {
        width: calc(50% - 6px); /* Half width minus half the gap */
        flex: 0 0 calc(50% - 6px);
        min-height: 80px;
        margin-top: 0;
    }
    
    /* Panels get full width */
    .price-range-panel,
    .open-interest-panel,
    .long-short-panel {
        width: 100%;
        margin: 12px 0 0 0;
    }
    
    /* Adjust container */
    .container {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 15px 10px;
        width: 92%;
        box-sizing: border-box;
    }
}

/* ...existing code... */
/* Improved market overview section alignment fixes */
.market-overview-section {
    width: 92%;
    max-width: 1100px;
    margin: 0 auto;
    padding: 0;
}

.market-overview-header {
    display: flex;
    justify-content: center;
    margin-bottom: 15px;
}

.market-controls-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    gap: 10px;
}

/* Improved search container styling */
.search-container {
    width: 100%;
    max-width: 300px; /* Smaller width */
    margin: 0 auto 10px;
    position: relative;
    display: flex;
    align-items: center;
}

.search-icon {
    position: absolute;
    left: 8px;
    color: #888;
}

.market-search {
    width: 100%;
    padding: 8px 8px 8px 35px;
    border-radius: 20px;
    border: 1px solid #ddd;
    font-size: 14px;
    box-sizing: border-box;
    outline: none;
}

.dark-theme .market-search {
    background-color: #202124;
    border-color: #444;
    color: #fff;
}

/* Improved filter buttons styling */
.filter-buttons {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 6px;
    width: 100%;
    max-width: 300px; /* Match search width */
    margin: 0 auto 10px;
}

.filter-btn {
    padding: 6px 12px;
    border-radius: 16px;
    border: 1px solid #ddd;
    background-color: #fff;
    color: #333;
    font-size: 13px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.filter-btn.active {
    background-color: #f6cb8e;
    border-color: #e6a93d;
    color: #333;
}

.dark-theme .filter-btn {
    background-color: #202124;
    border-color: #444;
    color: #ddd;
}

.dark-theme .filter-btn.active {
    background-color: #f6cb8e;
    border-color: #e6a93d;
    color: #333;
}

/* Time toggles styling */
.right-controls {
    width: 100%;
    display: flex;
    justify-content: center;
}

.time-toggles {
    display: flex;
    gap: 6px;
    max-width: 300px; /* Match other elements */
    margin: 0 auto;
}

.time-toggle {
    padding: 6px 12px;
    border-radius: 16px;
    border: 1px solid #ddd;
    background-color: #fff;
    color: #333;
    font-size: 13px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.time-toggle.active {
    background-color: #4daf7c;
    border-color: #3d8c64;
    color: white;
}

.dark-theme .time-toggle {
    background-color: #202124;
    border-color: #444;
    color: #ddd;
}

.dark-theme .time-toggle.active {
    background-color: #4daf7c;
    border-color: #3d8c64;
    color: white;
}

/* Responsive adjustments */
@media (min-width: 768px) {
    .market-controls-container {
        flex-direction: row;
        justify-content: space-between;
        margin-bottom: 15px;
    }
    
    .left-controls {
        width: auto;
        flex-direction: row;
        align-items: center;
        justify-content: flex-start;
    }
    
    .search-container {
        margin: 0 15px 0 0;
        width: 200px;
    }
    
    .filter-buttons {
        margin-bottom: 0;
        width: auto;
        max-width: none;
    }
    
    .right-controls {
        width: auto;
        justify-content: flex-end;
    }
    
    .time-toggles {
        margin: 0;
    }
}
/* Add these styles to prevent horizontal scrolling and extra space */
html, body {
    max-width: 100%;
    overflow-x: hidden;
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

/* Fix container sizing to prevent overflow */
.container, 
.market-overview-section {
    max-width: 100%;
    box-sizing: border-box;
    overflow-x: hidden;
}

/* Adjust button width to prevent expansion */
.button-container > button {
    width: 100%; /* Remove the calc(100% + 1px) that's causing overflow */
    margin-left: 0;
    box-sizing: border-box;
}
/* Add this to ensure proper width constraints for wider screens */
@media (min-width: 992px) {
    .container {
        max-width: 1100px;
        padding: 15px;
        margin: 0 auto;
    }
    
    .button-container {
        max-width: 1100px;
        margin: 0 auto 15px;
        grid-template-columns: repeat(3, minmax(0, 1fr));
        grid-gap: 20px;
    }
    
    .market-overview-section {
        max-width: 1100px;
        width: 92%;
        margin: 0 auto;
    }
    
    /* Fixed width for cards container */
    .crypto-cards-container {
        max-width: 1100px;
        margin: 0 auto;
    }
}

/* Fix button stretching */
@media (min-width: 768px) {
    .button-container > button {
        width: 100%;
        max-width: 100%;
        margin: 0;
    }
    
    .price-range-panel, 
    .open-interest-panel, 
    .long-short-panel {
        width: 100%;
        max-width: 100%;
        margin: 0;
    }
}

/* Hide header on larger screens */
/* Header layout adjustments */
.site-header {
    display: flex;
    justify-content: space-between; /* This spreads items to edges */
    align-items: center;
    padding: 15px 20px;
    position: relative;
    display: none; /* Hide by default */
    width: 100%;
    box-sizing: border-box;
}

/* Logo container aligned left */
.logo-container {
    display: flex;
    align-items: center;
    justify-content: flex-start; /* Changed from center to left alignment */
}

/* Controls aligned right */
.header-controls {
    position: static; /* Changed from absolute to static */
    display: flex;
    justify-content: flex-end;
}

/* Only display header on screens â‰¤ 990px */
@media (max-width: 990px) {
    .site-header {
        display: flex;
        margin-bottom: 10px;
    }
}

/* To be safe, explicitly hide on larger screens */
@media (min-width: 991px) {
    .site-header {
        display: none;
    }
}

/* Center everything globally */
.site-header,
.container,
.market-overview-section {
    margin-left: auto;
    margin-right: auto;
}

/* Ensure all elements play nicely within their containers */
.button-container > *,
.market-overview-section > * {
    box-sizing: border-box;
    max-width: 100%;
}

/* Prevent overly wide content */
body {
    display: flex;
    flex-direction: column;
    align-items: center;
}

body > * {
    width: 100%;
    max-width: 1100px;
}
/* Enhanced Side Navigation Styles */
.side-navigation {
    position: fixed;
    top: 0;
    left: 0;
    height: 100%;
    width: 70px;
    background-color: rgba(23, 24, 23, 0.9);
    box-shadow: 3px 0 15px rgba(0, 0, 0, 0.3);
    z-index: 1000;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px 0;
    transition: width 0.3s ease;
}

.side-navigation:hover {
    width: 200px;
}

.side-nav-items {
    list-style: none;
    padding: 0;
    margin: 0;
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-top: 60px;
}

.side-nav-item {
    width: 90%;
    margin: 6px 0;
    border-radius: 12px;
    overflow: hidden;
}

.side-nav-item a {
    display: flex;
    align-items: center;
    padding: 12px;
    color: white;
    text-decoration: none;
    transition: all 0.25s ease;
    border-radius: 12px;
    overflow: hidden;
    white-space: nowrap;
    margin-left: 5px;
}

.side-nav-item a:hover {
    background-color: rgba(255, 255, 255, 0.15);
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

.side-nav-item.active a {
    background-color: rgba(255, 255, 255, 0.2);
}

.nav-icon {
    font-size: 22px;
    margin-right: 15px;
    min-width: 22px;
    color: white;
    display: flex;
    justify-content: center;
}

.nav-label {
    font-size: 14px;
    font-weight: 500;
    opacity: 0;
    transition: opacity 0.3s ease;
    color: white;
}

.side-navigation:hover .nav-label {
    opacity: 1;
}

/* Light Theme Sidebar - always keep dark for consistency */
body:not(.dark-theme) .side-navigation {
    background-color: rgba(23, 24, 23, 0.9);
    backdrop-filter: blur(10px);
}

body:not(.dark-theme) .side-nav-item a {
    color: white;
}

body:not(.dark-theme) .side-nav-item a:hover {
    background-color: rgba(255, 255, 255, 0.15);
}

body:not(.dark-theme) .nav-icon {
    color: white;
}

body:not(.dark-theme) .nav-label {
    color: white;
}

/* Logo positioning at the top of sidebar */
.side-nav-logo {
    margin-top: 10px;
    margin-bottom: 30px;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.side-nav-logo img {
    width: 100%;
    height: auto;
    transition: all 0.3s ease;
}

.side-navigation:hover .side-nav-logo img {
    transform: scale(1.1);
}

/* Hide sidebar on small screens */
@media (max-width: 991px) {
    .side-navigation {
        display: none;
    }
}

/* Fix content shifting */
@media (min-width: 992px) {
    body {
        padding-left: 70px;
    }
    
    body > * {
        max-width: calc(1100px - 70px);
    }
    
    .side-navigation:hover + header,
    .side-navigation:hover ~ * {
        opacity: 0.97;
    }
}
    </style>
</body>
</html>
